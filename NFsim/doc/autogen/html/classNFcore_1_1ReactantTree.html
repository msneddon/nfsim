<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>NFsim: NFcore::ReactantTree Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="namespaceNFcore.html">NFcore</a>::<a class="el" href="classNFcore_1_1ReactantTree.html">ReactantTree</a></div>
<h1>NFcore::ReactantTree Class Reference</h1><!-- doxytag: class="NFcore::ReactantTree" --><!-- doxytag: inherits="NFcore::ReactantContainer" --><code>#include &lt;<a class="el" href="reactantTree_8hh-source.html">reactantTree.hh</a>&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for NFcore::ReactantTree:</div>
<div class="dynsection">

<p><center><img src="classNFcore_1_1ReactantTree.png" usemap="#NFcore::ReactantTree_map" border="0" alt=""></center>
<map name="NFcore::ReactantTree_map">
<area href="classNFcore_1_1ReactantContainer.html" alt="NFcore::ReactantContainer" shape="rect" coords="0,0,165,24">
</map>
</div>

<p>
<a href="classNFcore_1_1ReactantTree-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Maintains a tree of MappingSets needed by Distribution of Rates Reactions. 
<p>
This is one of the more complex classes in NFsim. It is written in order to handle distribution of rates reactions. These types of reactions have many reactants, but each reactant can participate with a different rate. The rate is determined by the set of molecules that the reactant is connected to. Therefore, we need a tree (or we could have also used logarithmic classes) to efficiently select the next reactant weighted by each of its propensities.<p>
A key example of this is in the chemotaxis system. Clusters of receptors influence the rate of CheA autophosphorylation. <table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#12da0834fff7d487a8f42292e7f325ae">ReactantTree</a> (unsigned int <a class="el" href="classNFcore_1_1ReactantTree.html#d1f496c045d8653b32c68843696d7ada">reactantIndex</a>, <a class="el" href="classNFcore_1_1TransformationSet.html">TransformationSet</a> *<a class="el" href="classNFcore_1_1ReactantTree.html#c1428823f5ce0c2da03b9add496e13c9">ts</a>, unsigned int init_capacity)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#aa3f46617dea88f5c2c8c9289bccd991">~ReactantTree</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#ef1e9f23adf8a29de2d011655c1ed13d">size</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classNFcore_1_1MappingSet.html">MappingSet</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#e4d30fa34fd659adacef3e11a6042a2a">pushNextAvailableMappingSet</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#746fcc68505724658fc30fb282fcc2d7">confirmPush</a> (int mappingSetId, double rateFactor)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#6fab52e4e443fa84cd9c8235f6d21219">popLastMappingSet</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#4428df5b215ef01bd3371191381719b4">removeMappingSet</a> (unsigned int mappingSetId)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#0ee274538b6a1e751ac8beea773ed79d">pickReactantFromValue</a> (<a class="el" href="classNFcore_1_1MappingSet.html">MappingSet</a> *&amp;ms, double value, double baseRate)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#0af2332db552c7fc4a80616ef0e5636d">updateValue</a> (unsigned int mappingSetId, double newRateFactor)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classNFcore_1_1MappingSet.html">MappingSet</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#210de2e1db684b548aee6e3f8519ec67">getMappingSet</a> (unsigned int mappingSetId) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#1824b471b5e766908f8a63f8e6ab347d">printDetails</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#bb9dee084a3bd0a6c9b6957c68c0865e">getRateFactorSum</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#98c28c19e8cd616555afc6fabe975107">getDepthOfTree</a> () const </td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#b9a70aa9798b413ccd8a44d756aeb88d">removeFromTreeOnly</a> (int msTreeArrayPosition, unsigned int mappingSetId)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#32d694cd16becbce5f75b38bc08c773c">expandTree</a> (int newCapacity)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classNFcore_1_1TransformationSet.html">TransformationSet</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#c1428823f5ce0c2da03b9add496e13c9">ts</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#d1f496c045d8653b32c68843696d7ada">reactantIndex</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#98df829058fc764be8d85245000aafe0">maxElementCount</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#90870dc3688a7f7b2be5dbd90b6f7b2d">treeDepth</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#11514f01532f7b0f286df1e4d806e3b2">numOfNodes</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#55f4c51ac3c0b426cce2b562c89c7d15">leftRateFactorSum</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#ba8b6fb6ace2e341974441bac27995b7">leftElementCount</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#35f6898d939641c2aaf4990f2718e4d8">rightElementCount</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classNFcore_1_1MappingSet.html">MappingSet</a> **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#c3ce03b2b2393165af3800ea34aed956">mappingSets</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#dab36f1618fcbc21352d95989432214f">msPositionMap</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#6e59dc3313cbe0491d401cc9cf7c1a14">msTreePositionMap</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#8a89ac522a999fdcb4c3e4df60b7f0a5">reverseMsTreePositionMap</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#879ca3d3ae77fc230370d22f0e5d0e2b">n_mappingSets</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNFcore_1_1ReactantTree.html#484daa5c6461995e503b78e293e902ab">firstMappingTreeIndex</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="12da0834fff7d487a8f42292e7f325ae"></a><!-- doxytag: member="NFcore::ReactantTree::ReactantTree" ref="12da0834fff7d487a8f42292e7f325ae" args="(unsigned int reactantIndex, TransformationSet *ts, unsigned int init_capacity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ReactantTree::ReactantTree           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>reactantIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNFcore_1_1TransformationSet.html">TransformationSet</a> *&nbsp;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>init_capacity</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a reactant tree, based on the given transformation set (so we can create mappings at the given reactant index. The tree will be initialized such that it can immediately hold the number of objects specified by the init_capacity. 
</div>
</div><p>
<a class="anchor" name="aa3f46617dea88f5c2c8c9289bccd991"></a><!-- doxytag: member="NFcore::ReactantTree::~ReactantTree" ref="aa3f46617dea88f5c2c8c9289bccd991" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ReactantTree::~ReactantTree           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Standard deconstructor for the tree 
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="ef1e9f23adf8a29de2d011655c1ed13d"></a><!-- doxytag: member="NFcore::ReactantTree::size" ref="ef1e9f23adf8a29de2d011655c1ed13d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual int NFcore::ReactantTree::size           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the number of mappingSets that have been added to this tree 
<p>Implements <a class="el" href="classNFcore_1_1ReactantContainer.html#5c8282ceba6fcdf04ea4708a9ec5056a">NFcore::ReactantContainer</a>.</p>

</div>
</div><p>
<a class="anchor" name="e4d30fa34fd659adacef3e11a6042a2a"></a><!-- doxytag: member="NFcore::ReactantTree::pushNextAvailableMappingSet" ref="e4d30fa34fd659adacef3e11a6042a2a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNFcore_1_1MappingSet.html">MappingSet</a> * ReactantTree::pushNextAvailableMappingSet           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a new <a class="el" href="classNFcore_1_1MappingSet.html" title="Keeps a list of mappings needed by a particular list of reactants.">MappingSet</a> to this tree and returns a pointer to the new mapping set for you to map (usually by comparing to some template molecule). Warning: even if you don't use this mapping set, it will be counted until you pop it or remove it! (see <a class="el" href="classNFcore_1_1ReactantTree.html#4428df5b215ef01bd3371191381719b4">removeMappingSet()</a>). This has a special behavior in the <a class="el" href="classNFcore_1_1ReactantTree.html" title="Maintains a tree of MappingSets needed by Distribution of Rates Reactions.">ReactantTree</a>. This method merely gets you a pointer to the next available mappingset: if you decide to keep the mapping, you have to confirm it. Confirming the mapping actually places it in the tree. If you don't do this, it won't ever be selected by the tree. 
<p>Implements <a class="el" href="classNFcore_1_1ReactantContainer.html#e49f41bfe7c16fa1961da77e3924f7a6">NFcore::ReactantContainer</a>.</p>

</div>
</div><p>
<a class="anchor" name="746fcc68505724658fc30fb282fcc2d7"></a><!-- doxytag: member="NFcore::ReactantTree::confirmPush" ref="746fcc68505724658fc30fb282fcc2d7" args="(int mappingSetId, double rateFactor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReactantTree::confirmPush           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mappingSetId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>rateFactor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Once you have pushed on the next available mappingSet, you have to confirm that push. In the event that mappingsets are cloned, this will confirm all mappingsets that have been cloned off of the given mapping set. 
</div>
</div><p>
<a class="anchor" name="6fab52e4e443fa84cd9c8235f6d21219"></a><!-- doxytag: member="NFcore::ReactantTree::popLastMappingSet" ref="6fab52e4e443fa84cd9c8235f6d21219" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReactantTree::popLastMappingSet           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Removes the very last mappingSet that was added to the list. You should actually now use the removeMappingSet function instead, just to be careful. 
<p>Implements <a class="el" href="classNFcore_1_1ReactantContainer.html#ea26d24f00e2632bd8c68210c0405293">NFcore::ReactantContainer</a>.</p>

</div>
</div><p>
<a class="anchor" name="4428df5b215ef01bd3371191381719b4"></a><!-- doxytag: member="NFcore::ReactantTree::removeMappingSet" ref="4428df5b215ef01bd3371191381719b4" args="(unsigned int mappingSetId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReactantTree::removeMappingSet           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>mappingSetId</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Removes the mapping set with the specified mappingSetId. Be careful here: make sure the mapping set is actually on the list before trying to remove or else this will give you an error! 
<p>Implements <a class="el" href="classNFcore_1_1ReactantContainer.html#109cc95b0cba4b0f6b122953009d7be9">NFcore::ReactantContainer</a>.</p>

</div>
</div><p>
<a class="anchor" name="0ee274538b6a1e751ac8beea773ed79d"></a><!-- doxytag: member="NFcore::ReactantTree::pickReactantFromValue" ref="0ee274538b6a1e751ac8beea773ed79d" args="(MappingSet *&amp;ms, double value, double baseRate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReactantTree::pickReactantFromValue           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNFcore_1_1MappingSet.html">MappingSet</a> *&amp;&nbsp;</td>
          <td class="paramname"> <em>ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>baseRate</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This is the key utility of a reactant tree: given a random value, we can select the next reactant to fire with this function that weights the selection of any particular reactant by 
</div>
</div><p>
<a class="anchor" name="0af2332db552c7fc4a80616ef0e5636d"></a><!-- doxytag: member="NFcore::ReactantTree::updateValue" ref="0af2332db552c7fc4a80616ef0e5636d" args="(unsigned int mappingSetId, double newRateFactor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReactantTree::updateValue           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>mappingSetId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>newRateFactor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
When a local function value changes, it must update the value in the reactant tree. This method allows you to update values without changing the mappingSet membership of this tree. 
</div>
</div><p>
<a class="anchor" name="210de2e1db684b548aee6e3f8519ec67"></a><!-- doxytag: member="NFcore::ReactantTree::getMappingSet" ref="210de2e1db684b548aee6e3f8519ec67" args="(unsigned int mappingSetId) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNFcore_1_1MappingSet.html">MappingSet</a> * ReactantTree::getMappingSet           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>mappingSetId</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a <a class="el" href="classNFcore_1_1MappingSet.html" title="Keeps a list of mappings needed by a particular list of reactants.">MappingSet</a> so that a DOR can evaluate a local function on it. 
<p>Implements <a class="el" href="classNFcore_1_1ReactantContainer.html#ed1f09a5f7224d2084ad1a487e36f189">NFcore::ReactantContainer</a>.</p>

</div>
</div><p>
<a class="anchor" name="1824b471b5e766908f8a63f8e6ab347d"></a><!-- doxytag: member="NFcore::ReactantTree::printDetails" ref="1824b471b5e766908f8a63f8e6ab347d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReactantTree::printDetails           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Outputs basic details about this tree - used only for debugging, because it really does print out everything 
<p>Implements <a class="el" href="classNFcore_1_1ReactantContainer.html#305122520e4c2b2fed2201b0bd307b76">NFcore::ReactantContainer</a>.</p>

</div>
</div><p>
<a class="anchor" name="bb9dee084a3bd0a6c9b6957c68c0865e"></a><!-- doxytag: member="NFcore::ReactantTree::getRateFactorSum" ref="bb9dee084a3bd0a6c9b6957c68c0865e" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double NFcore::ReactantTree::getRateFactorSum           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the combined rate factor sum of this tree, which is needed by the DOR reactionclass in order to properly update its propensity 
</div>
</div><p>
<a class="anchor" name="98c28c19e8cd616555afc6fabe975107"></a><!-- doxytag: member="NFcore::ReactantTree::getDepthOfTree" ref="98c28c19e8cd616555afc6fabe975107" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NFcore::ReactantTree::getDepthOfTree           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the depth of the tree (which you shouldn't ever really need...) 
</div>
</div><p>
<a class="anchor" name="b9a70aa9798b413ccd8a44d756aeb88d"></a><!-- doxytag: member="NFcore::ReactantTree::removeFromTreeOnly" ref="b9a70aa9798b413ccd8a44d756aeb88d" args="(int msTreeArrayPosition, unsigned int mappingSetId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReactantTree::removeFromTreeOnly           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>msTreeArrayPosition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>mappingSetId</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Removes a mapping set from the tree only. This method should only be used by the tree! 
</div>
</div><p>
<a class="anchor" name="32d694cd16becbce5f75b38bc08c773c"></a><!-- doxytag: member="NFcore::ReactantTree::expandTree" ref="32d694cd16becbce5f75b38bc08c773c" args="(int newCapacity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReactantTree::expandTree           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>newCapacity</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
If we try to add more than this tree can handle, we have to expand it. Because the tree is a complete binary tree, this will necessarily double its capacity, or enlarge it more depending on the given new capacity. 
<p>
Take special precaution here!! we don't want to actually reallocate the mappingSets! because then we would have to recompare each molecule to this template again! Instead, we will initialze only the end of this array, and fill in the rest of the array with the original elements, putting them in the proper position based on their id 
</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="c1428823f5ce0c2da03b9add496e13c9"></a><!-- doxytag: member="NFcore::ReactantTree::ts" ref="c1428823f5ce0c2da03b9add496e13c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNFcore_1_1TransformationSet.html">TransformationSet</a>* <a class="el" href="classNFcore_1_1ReactantTree.html#c1428823f5ce0c2da03b9add496e13c9">NFcore::ReactantTree::ts</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="d1f496c045d8653b32c68843696d7ada"></a><!-- doxytag: member="NFcore::ReactantTree::reactantIndex" ref="d1f496c045d8653b32c68843696d7ada" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classNFcore_1_1ReactantTree.html#d1f496c045d8653b32c68843696d7ada">NFcore::ReactantTree::reactantIndex</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="98df829058fc764be8d85245000aafe0"></a><!-- doxytag: member="NFcore::ReactantTree::maxElementCount" ref="98df829058fc764be8d85245000aafe0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classNFcore_1_1ReactantTree.html#98df829058fc764be8d85245000aafe0">NFcore::ReactantTree::maxElementCount</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="90870dc3688a7f7b2be5dbd90b6f7b2d"></a><!-- doxytag: member="NFcore::ReactantTree::treeDepth" ref="90870dc3688a7f7b2be5dbd90b6f7b2d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classNFcore_1_1ReactantTree.html#90870dc3688a7f7b2be5dbd90b6f7b2d">NFcore::ReactantTree::treeDepth</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="11514f01532f7b0f286df1e4d806e3b2"></a><!-- doxytag: member="NFcore::ReactantTree::numOfNodes" ref="11514f01532f7b0f286df1e4d806e3b2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classNFcore_1_1ReactantTree.html#11514f01532f7b0f286df1e4d806e3b2">NFcore::ReactantTree::numOfNodes</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="55f4c51ac3c0b426cce2b562c89c7d15"></a><!-- doxytag: member="NFcore::ReactantTree::leftRateFactorSum" ref="55f4c51ac3c0b426cce2b562c89c7d15" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* <a class="el" href="classNFcore_1_1ReactantTree.html#55f4c51ac3c0b426cce2b562c89c7d15">NFcore::ReactantTree::leftRateFactorSum</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="ba8b6fb6ace2e341974441bac27995b7"></a><!-- doxytag: member="NFcore::ReactantTree::leftElementCount" ref="ba8b6fb6ace2e341974441bac27995b7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* <a class="el" href="classNFcore_1_1ReactantTree.html#ba8b6fb6ace2e341974441bac27995b7">NFcore::ReactantTree::leftElementCount</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="35f6898d939641c2aaf4990f2718e4d8"></a><!-- doxytag: member="NFcore::ReactantTree::rightElementCount" ref="35f6898d939641c2aaf4990f2718e4d8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* <a class="el" href="classNFcore_1_1ReactantTree.html#35f6898d939641c2aaf4990f2718e4d8">NFcore::ReactantTree::rightElementCount</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="c3ce03b2b2393165af3800ea34aed956"></a><!-- doxytag: member="NFcore::ReactantTree::mappingSets" ref="c3ce03b2b2393165af3800ea34aed956" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNFcore_1_1MappingSet.html">MappingSet</a>** <a class="el" href="classNFcore_1_1ReactantTree.html#c3ce03b2b2393165af3800ea34aed956">NFcore::ReactantTree::mappingSets</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="dab36f1618fcbc21352d95989432214f"></a><!-- doxytag: member="NFcore::ReactantTree::msPositionMap" ref="dab36f1618fcbc21352d95989432214f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* <a class="el" href="classNFcore_1_1ReactantTree.html#dab36f1618fcbc21352d95989432214f">NFcore::ReactantTree::msPositionMap</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="6e59dc3313cbe0491d401cc9cf7c1a14"></a><!-- doxytag: member="NFcore::ReactantTree::msTreePositionMap" ref="6e59dc3313cbe0491d401cc9cf7c1a14" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* <a class="el" href="classNFcore_1_1ReactantTree.html#6e59dc3313cbe0491d401cc9cf7c1a14">NFcore::ReactantTree::msTreePositionMap</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="8a89ac522a999fdcb4c3e4df60b7f0a5"></a><!-- doxytag: member="NFcore::ReactantTree::reverseMsTreePositionMap" ref="8a89ac522a999fdcb4c3e4df60b7f0a5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* <a class="el" href="classNFcore_1_1ReactantTree.html#8a89ac522a999fdcb4c3e4df60b7f0a5">NFcore::ReactantTree::reverseMsTreePositionMap</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="879ca3d3ae77fc230370d22f0e5d0e2b"></a><!-- doxytag: member="NFcore::ReactantTree::n_mappingSets" ref="879ca3d3ae77fc230370d22f0e5d0e2b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classNFcore_1_1ReactantTree.html#879ca3d3ae77fc230370d22f0e5d0e2b">NFcore::ReactantTree::n_mappingSets</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="484daa5c6461995e503b78e293e902ab"></a><!-- doxytag: member="NFcore::ReactantTree::firstMappingTreeIndex" ref="484daa5c6461995e503b78e293e902ab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classNFcore_1_1ReactantTree.html#484daa5c6461995e503b78e293e902ab">NFcore::ReactantTree::firstMappingTreeIndex</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>/home/msneddon/eclipse/galileoSR1_cpp/workspace/NFsim/src/NFreactions/reactantLists/<a class="el" href="reactantTree_8hh-source.html">reactantTree.hh</a><li>/home/msneddon/eclipse/galileoSR1_cpp/workspace/NFsim/src/NFreactions/reactantLists/<a class="el" href="reactantTree_8cpp.html">reactantTree.cpp</a></ul>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Mar 9 10:08:52 2011 for NFsim by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
